"use strict";(self.webpackChunkroomz_web_app=self.webpackChunkroomz_web_app||[]).push([[329],{5329:(yn,K,l)=>{l.r(K),l.d(K,{MessagesModule:()=>_n});var R={};l.r(R),l.d(R,{Decoder:()=>Q,Encoder:()=>pe,PacketType:()=>c,protocol:()=>bt});var z={};l.r(z),l.d(z,{Manager:()=>Z,Socket:()=>H,connect:()=>m,default:()=>m,io:()=>m,protocol:()=>bt});var y=l(9808),Tt=l(978),A=l(1062),X=l(727),x=l(2340),e=l(5e3),At=l(1135);const g=Object.create(null);g.open="0",g.close="1",g.ping="2",g.pong="3",g.message="4",g.upgrade="5",g.noop="6";const D=Object.create(null);Object.keys(g).forEach(s=>{D[g[s]]=s});const Dt={type:"error",data:"parser error"},Et="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),St="function"==typeof ArrayBuffer,j=(s,n)=>{const t=new FileReader;return t.onload=function(){const i=t.result.split(",")[1];n("b"+i)},t.readAsDataURL(s)},W=({type:s,data:n},t,i)=>Et&&n instanceof Blob?t?i(n):j(n,i):St&&(n instanceof ArrayBuffer||(s=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(s):s&&s.buffer instanceof ArrayBuffer)(n))?t?i(n):j(new Blob([n]),i):i(g[s]+(n||"")),C="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",M="undefined"==typeof Uint8Array?[]:new Uint8Array(256);for(let s=0;s<C.length;s++)M[C.charCodeAt(s)]=s;const Zt="function"==typeof ArrayBuffer,Rt=(s,n)=>{if(Zt){const t=(s=>{let i,r,a,h,d,n=.75*s.length,t=s.length,o=0;"="===s[s.length-1]&&(n--,"="===s[s.length-2]&&n--);const _=new ArrayBuffer(n),f=new Uint8Array(_);for(i=0;i<t;i+=4)r=M[s.charCodeAt(i)],a=M[s.charCodeAt(i+1)],h=M[s.charCodeAt(i+2)],d=M[s.charCodeAt(i+3)],f[o++]=r<<2|a>>4,f[o++]=(15&a)<<4|h>>2,f[o++]=(3&h)<<6|63&d;return _})(s);return G(t,n)}return{base64:!0,data:s}},G=(s,n)=>"blob"===n&&s instanceof ArrayBuffer?new Blob([s]):s,tt=(s,n)=>{if("string"!=typeof s)return{type:"message",data:G(s,n)};const t=s.charAt(0);return"b"===t?{type:"message",data:Rt(s.substring(1),n)}:D[t]?s.length>1?{type:D[t],data:s.substring(1)}:{type:D[t]}:Dt},et=String.fromCharCode(30);function u(s){if(s)return function Ut(s){for(var n in u.prototype)s[n]=u.prototype[n];return s}(s)}u.prototype.on=u.prototype.addEventListener=function(s,n){return this._callbacks=this._callbacks||{},(this._callbacks["$"+s]=this._callbacks["$"+s]||[]).push(n),this},u.prototype.once=function(s,n){function t(){this.off(s,t),n.apply(this,arguments)}return t.fn=n,this.on(s,t),this},u.prototype.off=u.prototype.removeListener=u.prototype.removeAllListeners=u.prototype.removeEventListener=function(s,n){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var t=this._callbacks["$"+s];if(!t)return this;if(1==arguments.length)return delete this._callbacks["$"+s],this;for(var i,o=0;o<t.length;o++)if((i=t[o])===n||i.fn===n){t.splice(o,1);break}return 0===t.length&&delete this._callbacks["$"+s],this},u.prototype.emitReserved=u.prototype.emit=function(s){this._callbacks=this._callbacks||{};for(var n=new Array(arguments.length-1),t=this._callbacks["$"+s],i=1;i<arguments.length;i++)n[i-1]=arguments[i];if(t){i=0;for(var o=(t=t.slice(0)).length;i<o;++i)t[i].apply(this,n)}return this},u.prototype.listeners=function(s){return this._callbacks=this._callbacks||{},this._callbacks["$"+s]||[]},u.prototype.hasListeners=function(s){return!!this.listeners(s).length};const b="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")();function st(s,...n){return n.reduce((t,i)=>(s.hasOwnProperty(i)&&(t[i]=s[i]),t),{})}const Ft=setTimeout,Jt=clearTimeout;function E(s,n){n.useNativeTimers?(s.setTimeoutFn=Ft.bind(b),s.clearTimeoutFn=Jt.bind(b)):(s.setTimeoutFn=setTimeout.bind(b),s.clearTimeoutFn=clearTimeout.bind(b))}function Qt(s){return"string"==typeof s?function Ht(s){let n=0,t=0;for(let i=0,o=s.length;i<o;i++)n=s.charCodeAt(i),n<128?t+=1:n<2048?t+=2:n<55296||n>=57344?t+=3:(i++,t+=4);return t}(s):Math.ceil(1.33*(s.byteLength||s.size))}class Vt extends Error{constructor(n,t,i){super(n),this.description=t,this.context=i,this.type="TransportError"}}class it extends u{constructor(n){super(),this.writable=!1,E(this,n),this.opts=n,this.query=n.query,this.readyState="",this.socket=n.socket}onError(n,t,i){return super.emitReserved("error",new Vt(n,t,i)),this}open(){return("closed"===this.readyState||""===this.readyState)&&(this.readyState="opening",this.doOpen()),this}close(){return("opening"===this.readyState||"open"===this.readyState)&&(this.doClose(),this.onClose()),this}send(n){"open"===this.readyState&&this.write(n)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(n){const t=tt(n,this.socket.binaryType);this.onPacket(t)}onPacket(n){super.emitReserved("packet",n)}onClose(n){this.readyState="closed",super.emitReserved("close",n)}}const ot="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),rt={};let ct,at=0,v=0;function lt(s){let n="";do{n=ot[s%64]+n,s=Math.floor(s/64)}while(s>0);return n}function ht(){const s=lt(+new Date);return s!==ct?(at=0,ct=s):s+"."+lt(at++)}for(;v<64;v++)rt[ot[v]]=v;function ut(s){let n="";for(let t in s)s.hasOwnProperty(t)&&(n.length&&(n+="&"),n+=encodeURIComponent(t)+"="+encodeURIComponent(s[t]));return n}let dt=!1;try{dt="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(s){}const Kt=dt;function pt(s){const n=s.xdomain;try{if("undefined"!=typeof XMLHttpRequest&&(!n||Kt))return new XMLHttpRequest}catch(t){}if(!n)try{return new(b[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(t){}}function Xt(){}const jt=null!=new pt({xdomain:!1}).responseType;let L=(()=>{class s extends u{constructor(t,i){super(),E(this,i),this.opts=i,this.method=i.method||"GET",this.uri=t,this.async=!1!==i.async,this.data=void 0!==i.data?i.data:null,this.create()}create(){const t=st(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this.opts.xd,t.xscheme=!!this.opts.xs;const i=this.xhr=new pt(t);try{i.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders){i.setDisableHeaderCheck&&i.setDisableHeaderCheck(!0);for(let o in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(o)&&i.setRequestHeader(o,this.opts.extraHeaders[o])}}catch(o){}if("POST"===this.method)try{i.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(o){}try{i.setRequestHeader("Accept","*/*")}catch(o){}"withCredentials"in i&&(i.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(i.timeout=this.opts.requestTimeout),i.onreadystatechange=()=>{4===i.readyState&&(200===i.status||1223===i.status?this.onLoad():this.setTimeoutFn(()=>{this.onError("number"==typeof i.status?i.status:0)},0))},i.send(this.data)}catch(o){return void this.setTimeoutFn(()=>{this.onError(o)},0)}"undefined"!=typeof document&&(this.index=s.requestsCount++,s.requests[this.index]=this)}onError(t){this.emitReserved("error",t,this.xhr),this.cleanup(!0)}cleanup(t){if(null!=this.xhr){if(this.xhr.onreadystatechange=Xt,t)try{this.xhr.abort()}catch(i){}"undefined"!=typeof document&&delete s.requests[this.index],this.xhr=null}}onLoad(){const t=this.xhr.responseText;null!==t&&(this.emitReserved("data",t),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}}return s.requestsCount=0,s.requests={},s})();function gt(){for(let s in L.requests)L.requests.hasOwnProperty(s)&&L.requests[s].abort()}"undefined"!=typeof document&&("function"==typeof attachEvent?attachEvent("onunload",gt):"function"==typeof addEventListener&&addEventListener("onpagehide"in b?"pagehide":"unload",gt,!1));const ft="function"==typeof Promise&&"function"==typeof Promise.resolve?n=>Promise.resolve().then(n):(n,t)=>t(n,0),B=b.WebSocket||b.MozWebSocket,mt="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),ee={websocket:class te extends it{constructor(n){super(n),this.supportsBinary=!n.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;const n=this.uri(),t=this.opts.protocols,i=mt?{}:st(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(i.headers=this.opts.extraHeaders);try{this.ws=mt?new B(n,t,i):t?new B(n,t):new B(n)}catch(o){return this.emitReserved("error",o)}this.ws.binaryType=this.socket.binaryType||"arraybuffer",this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=n=>this.onClose({description:"websocket connection closed",context:n}),this.ws.onmessage=n=>this.onData(n.data),this.ws.onerror=n=>this.onError("websocket error",n)}write(n){this.writable=!1;for(let t=0;t<n.length;t++){const o=t===n.length-1;W(n[t],this.supportsBinary,r=>{try{this.ws.send(r)}catch(h){}o&&ft(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){void 0!==this.ws&&(this.ws.close(),this.ws=null)}uri(){let n=this.query||{};const t=this.opts.secure?"wss":"ws";let i="";this.opts.port&&("wss"===t&&443!==Number(this.opts.port)||"ws"===t&&80!==Number(this.opts.port))&&(i=":"+this.opts.port),this.opts.timestampRequests&&(n[this.opts.timestampParam]=ht()),this.supportsBinary||(n.b64=1);const o=ut(n);return t+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+i+this.opts.path+(o.length?"?"+o:"")}check(){return!!B}},polling:class Wt extends it{constructor(n){if(super(n),this.polling=!1,"undefined"!=typeof location){const i="https:"===location.protocol;let o=location.port;o||(o=i?"443":"80"),this.xd="undefined"!=typeof location&&n.hostname!==location.hostname||o!==n.port,this.xs=n.secure!==i}this.supportsBinary=jt&&!(n&&n.forceBase64)}get name(){return"polling"}doOpen(){this.poll()}pause(n){this.readyState="pausing";const t=()=>{this.readyState="paused",n()};if(this.polling||!this.writable){let i=0;this.polling&&(i++,this.once("pollComplete",function(){--i||t()})),this.writable||(i++,this.once("drain",function(){--i||t()}))}else t()}poll(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(n){((s,n)=>{const t=s.split(et),i=[];for(let o=0;o<t.length;o++){const r=tt(t[o],n);if(i.push(r),"error"===r.type)break}return i})(n,this.socket.binaryType).forEach(i=>{if("opening"===this.readyState&&"open"===i.type&&this.onOpen(),"close"===i.type)return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(i)}),"closed"!==this.readyState&&(this.polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState&&this.poll())}doClose(){const n=()=>{this.write([{type:"close"}])};"open"===this.readyState?n():this.once("open",n)}write(n){this.writable=!1,((s,n)=>{const t=s.length,i=new Array(t);let o=0;s.forEach((r,a)=>{W(r,!1,h=>{i[a]=h,++o===t&&n(i.join(et))})})})(n,t=>{this.doWrite(t,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){let n=this.query||{};const t=this.opts.secure?"https":"http";let i="";!1!==this.opts.timestampRequests&&(n[this.opts.timestampParam]=ht()),!this.supportsBinary&&!n.sid&&(n.b64=1),this.opts.port&&("https"===t&&443!==Number(this.opts.port)||"http"===t&&80!==Number(this.opts.port))&&(i=":"+this.opts.port);const o=ut(n);return t+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+i+this.opts.path+(o.length?"?"+o:"")}request(n={}){return Object.assign(n,{xd:this.xd,xs:this.xs},this.opts),new L(this.uri(),n)}doWrite(n,t){const i=this.request({method:"POST",data:n});i.on("success",t),i.on("error",(o,r)=>{this.onError("xhr post error",o,r)})}doPoll(){const n=this.request();n.on("data",this.onData.bind(this)),n.on("error",(t,i)=>{this.onError("xhr poll error",t,i)}),this.pollXhr=n}}},ne=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,se=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function U(s){const n=s,t=s.indexOf("["),i=s.indexOf("]");-1!=t&&-1!=i&&(s=s.substring(0,t)+s.substring(t,i).replace(/:/g,";")+s.substring(i,s.length));let o=ne.exec(s||""),r={},a=14;for(;a--;)r[se[a]]=o[a]||"";return-1!=t&&-1!=i&&(r.source=n,r.host=r.host.substring(1,r.host.length-1).replace(/;/g,":"),r.authority=r.authority.replace("[","").replace("]","").replace(/;/g,":"),r.ipv6uri=!0),r.pathNames=function ie(s,n){const i=n.replace(/\/{2,9}/g,"/").split("/");return("/"==n.slice(0,1)||0===n.length)&&i.splice(0,1),"/"==n.slice(-1)&&i.splice(i.length-1,1),i}(0,r.path),r.queryKey=function oe(s,n){const t={};return n.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(i,o,r){o&&(t[o]=r)}),t}(0,r.query),r}let _t=(()=>{class s extends u{constructor(t,i={}){super(),t&&"object"==typeof t&&(i=t,t=null),t?(t=U(t),i.hostname=t.host,i.secure="https"===t.protocol||"wss"===t.protocol,i.port=t.port,t.query&&(i.query=t.query)):i.host&&(i.hostname=U(i.host).host),E(this,i),this.secure=null!=i.secure?i.secure:"undefined"!=typeof location&&"https:"===location.protocol,i.hostname&&!i.port&&(i.port=this.secure?"443":"80"),this.hostname=i.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=i.port||("undefined"!=typeof location&&location.port?location.port:this.secure?"443":"80"),this.transports=i.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},i),this.opts.path=this.opts.path.replace(/\/$/,"")+"/","string"==typeof this.opts.query&&(this.opts.query=function $t(s){let n={},t=s.split("&");for(let i=0,o=t.length;i<o;i++){let r=t[i].split("=");n[decodeURIComponent(r[0])]=decodeURIComponent(r[1])}return n}(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,"function"==typeof addEventListener&&(this.opts.closeOnBeforeunload&&(this.beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this.beforeunloadEventListener,!1)),"localhost"!==this.hostname&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(t){const i=Object.assign({},this.opts.query);i.EIO=4,i.transport=t,this.id&&(i.sid=this.id);const o=Object.assign({},this.opts.transportOptions[t],this.opts,{query:i,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return new ee[t](o)}open(){let t;if(this.opts.rememberUpgrade&&s.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))t="websocket";else{if(0===this.transports.length)return void this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);t=this.transports[0]}this.readyState="opening";try{t=this.createTransport(t)}catch(i){return this.transports.shift(),void this.open()}t.open(),this.setTransport(t)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",i=>this.onClose("transport close",i))}probe(t){let i=this.createTransport(t),o=!1;s.priorWebsocketSuccess=!1;const r=()=>{o||(i.send([{type:"ping",data:"probe"}]),i.once("packet",O=>{if(!o)if("pong"===O.type&&"probe"===O.data){if(this.upgrading=!0,this.emitReserved("upgrading",i),!i)return;s.priorWebsocketSuccess="websocket"===i.name,this.transport.pause(()=>{o||"closed"!==this.readyState&&(wt(),this.setTransport(i),i.send([{type:"upgrade"}]),this.emitReserved("upgrade",i),i=null,this.upgrading=!1,this.flush())})}else{const T=new Error("probe error");T.transport=i.name,this.emitReserved("upgradeError",T)}}))};function a(){o||(o=!0,wt(),i.close(),i=null)}const h=O=>{const T=new Error("probe error: "+O);T.transport=i.name,a(),this.emitReserved("upgradeError",T)};function d(){h("transport closed")}function _(){h("socket closed")}function f(O){i&&O.name!==i.name&&a()}const wt=()=>{i.removeListener("open",r),i.removeListener("error",h),i.removeListener("close",d),this.off("close",_),this.off("upgrading",f)};i.once("open",r),i.once("error",h),i.once("close",d),this.once("close",_),this.once("upgrading",f),i.open()}onOpen(){if(this.readyState="open",s.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush(),"open"===this.readyState&&this.opts.upgrade&&this.transport.pause){let t=0;const i=this.upgrades.length;for(;t<i;t++)this.probe(this.upgrades[t])}}onPacket(t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":const i=new Error("server error");i.code=t.data,this.onError(i);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data)}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this.upgrades=this.filterUpgrades(t.upgrades),this.pingInterval=t.pingInterval,this.pingTimeout=t.pingTimeout,this.maxPayload=t.maxPayload,this.onOpen(),"closed"!==this.readyState&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn(()=>{this.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const t=this.getWritablePackets();this.transport.send(t),this.prevBufferLen=t.length,this.emitReserved("flush")}}getWritablePackets(){if(!(this.maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1))return this.writeBuffer;let i=1;for(let o=0;o<this.writeBuffer.length;o++){const r=this.writeBuffer[o].data;if(r&&(i+=Qt(r)),o>0&&i>this.maxPayload)return this.writeBuffer.slice(0,o);i+=2}return this.writeBuffer}write(t,i,o){return this.sendPacket("message",t,i,o),this}send(t,i,o){return this.sendPacket("message",t,i,o),this}sendPacket(t,i,o,r){if("function"==typeof i&&(r=i,i=void 0),"function"==typeof o&&(r=o,o=null),"closing"===this.readyState||"closed"===this.readyState)return;(o=o||{}).compress=!1!==o.compress;const a={type:t,data:i,options:o};this.emitReserved("packetCreate",a),this.writeBuffer.push(a),r&&this.once("flush",r),this.flush()}close(){const t=()=>{this.onClose("forced close"),this.transport.close()},i=()=>{this.off("upgrade",i),this.off("upgradeError",i),t()},o=()=>{this.once("upgrade",i),this.once("upgradeError",i)};return("opening"===this.readyState||"open"===this.readyState)&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?o():t()}):this.upgrading?o():t()),this}onError(t){s.priorWebsocketSuccess=!1,this.emitReserved("error",t),this.onClose("transport error",t)}onClose(t,i){("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)&&(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),"function"==typeof removeEventListener&&(removeEventListener("beforeunload",this.beforeunloadEventListener,!1),removeEventListener("offline",this.offlineEventListener,!1)),this.readyState="closed",this.id=null,this.emitReserved("close",t,i),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(t){const i=[];let o=0;const r=t.length;for(;o<r;o++)~this.transports.indexOf(t[o])&&i.push(t[o]);return i}}return s.protocol=4,s})();const ae="function"==typeof ArrayBuffer,yt=Object.prototype.toString,le="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===yt.call(Blob),he="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===yt.call(File);function F(s){return ae&&(s instanceof ArrayBuffer||(s=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(s):s.buffer instanceof ArrayBuffer)(s))||le&&s instanceof Blob||he&&s instanceof File}function N(s,n){if(!s||"object"!=typeof s)return!1;if(Array.isArray(s)){for(let t=0,i=s.length;t<i;t++)if(N(s[t]))return!0;return!1}if(F(s))return!0;if(s.toJSON&&"function"==typeof s.toJSON&&1===arguments.length)return N(s.toJSON(),!0);for(const t in s)if(Object.prototype.hasOwnProperty.call(s,t)&&N(s[t]))return!0;return!1}function ue(s){const n=[],i=s;return i.data=J(s.data,n),i.attachments=n.length,{packet:i,buffers:n}}function J(s,n){if(!s)return s;if(F(s)){const t={_placeholder:!0,num:n.length};return n.push(s),t}if(Array.isArray(s)){const t=new Array(s.length);for(let i=0;i<s.length;i++)t[i]=J(s[i],n);return t}if("object"==typeof s&&!(s instanceof Date)){const t={};for(const i in s)Object.prototype.hasOwnProperty.call(s,i)&&(t[i]=J(s[i],n));return t}return s}function de(s,n){return s.data=Y(s.data,n),s.attachments=void 0,s}function Y(s,n){if(!s)return s;if(s&&!0===s._placeholder){if("number"==typeof s.num&&s.num>=0&&s.num<n.length)return n[s.num];throw new Error("illegal attachments")}if(Array.isArray(s))for(let t=0;t<s.length;t++)s[t]=Y(s[t],n);else if("object"==typeof s)for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&(s[t]=Y(s[t],n));return s}const bt=5;var c=(()=>{return(s=c||(c={}))[s.CONNECT=0]="CONNECT",s[s.DISCONNECT=1]="DISCONNECT",s[s.EVENT=2]="EVENT",s[s.ACK=3]="ACK",s[s.CONNECT_ERROR=4]="CONNECT_ERROR",s[s.BINARY_EVENT=5]="BINARY_EVENT",s[s.BINARY_ACK=6]="BINARY_ACK",c;var s})();class pe{constructor(n){this.replacer=n}encode(n){return n.type!==c.EVENT&&n.type!==c.ACK||!N(n)?[this.encodeAsString(n)]:(n.type=n.type===c.EVENT?c.BINARY_EVENT:c.BINARY_ACK,this.encodeAsBinary(n))}encodeAsString(n){let t=""+n.type;return(n.type===c.BINARY_EVENT||n.type===c.BINARY_ACK)&&(t+=n.attachments+"-"),n.nsp&&"/"!==n.nsp&&(t+=n.nsp+","),null!=n.id&&(t+=n.id),null!=n.data&&(t+=JSON.stringify(n.data,this.replacer)),t}encodeAsBinary(n){const t=ue(n),i=this.encodeAsString(t.packet),o=t.buffers;return o.unshift(i),o}}class Q extends u{constructor(n){super(),this.reviver=n}add(n){let t;if("string"==typeof n){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(n),t.type===c.BINARY_EVENT||t.type===c.BINARY_ACK?(this.reconstructor=new ge(t),0===t.attachments&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else{if(!F(n)&&!n.base64)throw new Error("Unknown type: "+n);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");t=this.reconstructor.takeBinaryData(n),t&&(this.reconstructor=null,super.emitReserved("decoded",t))}}decodeString(n){let t=0;const i={type:Number(n.charAt(0))};if(void 0===c[i.type])throw new Error("unknown packet type "+i.type);if(i.type===c.BINARY_EVENT||i.type===c.BINARY_ACK){const r=t+1;for(;"-"!==n.charAt(++t)&&t!=n.length;);const a=n.substring(r,t);if(a!=Number(a)||"-"!==n.charAt(t))throw new Error("Illegal attachments");i.attachments=Number(a)}if("/"===n.charAt(t+1)){const r=t+1;for(;++t&&","!==n.charAt(t)&&t!==n.length;);i.nsp=n.substring(r,t)}else i.nsp="/";const o=n.charAt(t+1);if(""!==o&&Number(o)==o){const r=t+1;for(;++t;){const a=n.charAt(t);if(null==a||Number(a)!=a){--t;break}if(t===n.length)break}i.id=Number(n.substring(r,t+1))}if(n.charAt(++t)){const r=this.tryParse(n.substr(t));if(!Q.isPayloadValid(i.type,r))throw new Error("invalid payload");i.data=r}return i}tryParse(n){try{return JSON.parse(n,this.reviver)}catch(t){return!1}}static isPayloadValid(n,t){switch(n){case c.CONNECT:return"object"==typeof t;case c.DISCONNECT:return void 0===t;case c.CONNECT_ERROR:return"string"==typeof t||"object"==typeof t;case c.EVENT:case c.BINARY_EVENT:return Array.isArray(t)&&t.length>0;case c.ACK:case c.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&this.reconstructor.finishedReconstruction()}}class ge{constructor(n){this.packet=n,this.buffers=[],this.reconPack=n}takeBinaryData(n){if(this.buffers.push(n),this.buffers.length===this.reconPack.attachments){const t=de(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function p(s,n,t){return s.on(n,t),function(){s.off(n,t)}}const fe=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class H extends u{constructor(n,t,i){super(),this.connected=!1,this.receiveBuffer=[],this.sendBuffer=[],this.ids=0,this.acks={},this.flags={},this.io=n,this.nsp=t,i&&i.auth&&(this.auth=i.auth),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const n=this.io;this.subs=[p(n,"open",this.onopen.bind(this)),p(n,"packet",this.onpacket.bind(this)),p(n,"error",this.onerror.bind(this)),p(n,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(...n){return n.unshift("message"),this.emit.apply(this,n),this}emit(n,...t){if(fe.hasOwnProperty(n))throw new Error('"'+n.toString()+'" is a reserved event name');t.unshift(n);const i={type:c.EVENT,data:t,options:{}};if(i.options.compress=!1!==this.flags.compress,"function"==typeof t[t.length-1]){const a=this.ids++,h=t.pop();this._registerAckCallback(a,h),i.id=a}return this.flags.volatile&&(!(this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable)||!this.connected)||(this.connected?(this.notifyOutgoingListeners(i),this.packet(i)):this.sendBuffer.push(i)),this.flags={},this}_registerAckCallback(n,t){const i=this.flags.timeout;if(void 0===i)return void(this.acks[n]=t);const o=this.io.setTimeoutFn(()=>{delete this.acks[n];for(let r=0;r<this.sendBuffer.length;r++)this.sendBuffer[r].id===n&&this.sendBuffer.splice(r,1);t.call(this,new Error("operation has timed out"))},i);this.acks[n]=(...r)=>{this.io.clearTimeoutFn(o),t.apply(this,[null,...r])}}packet(n){n.nsp=this.nsp,this.io._packet(n)}onopen(){"function"==typeof this.auth?this.auth(n=>{this.packet({type:c.CONNECT,data:n})}):this.packet({type:c.CONNECT,data:this.auth})}onerror(n){this.connected||this.emitReserved("connect_error",n)}onclose(n,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",n,t)}onpacket(n){if(n.nsp===this.nsp)switch(n.type){case c.CONNECT:n.data&&n.data.sid?this.onconnect(n.data.sid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case c.EVENT:case c.BINARY_EVENT:this.onevent(n);break;case c.ACK:case c.BINARY_ACK:this.onack(n);break;case c.DISCONNECT:this.ondisconnect();break;case c.CONNECT_ERROR:this.destroy();const i=new Error(n.data.message);i.data=n.data.data,this.emitReserved("connect_error",i)}}onevent(n){const t=n.data||[];null!=n.id&&t.push(this.ack(n.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(n){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const i of t)i.apply(this,n)}super.emit.apply(this,n)}ack(n){const t=this;let i=!1;return function(...o){i||(i=!0,t.packet({type:c.ACK,id:n,data:o}))}}onack(n){const t=this.acks[n.id];"function"==typeof t&&(t.apply(this,n.data),delete this.acks[n.id])}onconnect(n){this.id=n,this.connected=!0,this.emitBuffered(),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(n=>this.emitEvent(n)),this.receiveBuffer=[],this.sendBuffer.forEach(n=>{this.notifyOutgoingListeners(n),this.packet(n)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(n=>n()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:c.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(n){return this.flags.compress=n,this}get volatile(){return this.flags.volatile=!0,this}timeout(n){return this.flags.timeout=n,this}onAny(n){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(n),this}prependAny(n){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(n),this}offAny(n){if(!this._anyListeners)return this;if(n){const t=this._anyListeners;for(let i=0;i<t.length;i++)if(n===t[i])return t.splice(i,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(n){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(n),this}prependAnyOutgoing(n){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(n),this}offAnyOutgoing(n){if(!this._anyOutgoingListeners)return this;if(n){const t=this._anyOutgoingListeners;for(let i=0;i<t.length;i++)if(n===t[i])return t.splice(i,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(n){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const t=this._anyOutgoingListeners.slice();for(const i of t)i.apply(this,n.data)}}}function k(s){this.ms=(s=s||{}).min||100,this.max=s.max||1e4,this.factor=s.factor||2,this.jitter=s.jitter>0&&s.jitter<=1?s.jitter:0,this.attempts=0}k.prototype.duration=function(){var s=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var n=Math.random(),t=Math.floor(n*this.jitter*s);s=0==(1&Math.floor(10*n))?s-t:s+t}return 0|Math.min(s,this.max)},k.prototype.reset=function(){this.attempts=0},k.prototype.setMin=function(s){this.ms=s},k.prototype.setMax=function(s){this.max=s},k.prototype.setJitter=function(s){this.jitter=s};class Z extends u{constructor(n,t){var i;super(),this.nsps={},this.subs=[],n&&"object"==typeof n&&(t=n,n=void 0),(t=t||{}).path=t.path||"/socket.io",this.opts=t,E(this,t),this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(null!==(i=t.randomizationFactor)&&void 0!==i?i:.5),this.backoff=new k({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this._readyState="closed",this.uri=n;const o=t.parser||R;this.encoder=new o.Encoder,this.decoder=new o.Decoder,this._autoConnect=!1!==t.autoConnect,this._autoConnect&&this.open()}reconnection(n){return arguments.length?(this._reconnection=!!n,this):this._reconnection}reconnectionAttempts(n){return void 0===n?this._reconnectionAttempts:(this._reconnectionAttempts=n,this)}reconnectionDelay(n){var t;return void 0===n?this._reconnectionDelay:(this._reconnectionDelay=n,null===(t=this.backoff)||void 0===t||t.setMin(n),this)}randomizationFactor(n){var t;return void 0===n?this._randomizationFactor:(this._randomizationFactor=n,null===(t=this.backoff)||void 0===t||t.setJitter(n),this)}reconnectionDelayMax(n){var t;return void 0===n?this._reconnectionDelayMax:(this._reconnectionDelayMax=n,null===(t=this.backoff)||void 0===t||t.setMax(n),this)}timeout(n){return arguments.length?(this._timeout=n,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(n){if(~this._readyState.indexOf("open"))return this;this.engine=new _t(this.uri,this.opts);const t=this.engine,i=this;this._readyState="opening",this.skipReconnect=!1;const o=p(t,"open",function(){i.onopen(),n&&n()}),r=p(t,"error",a=>{i.cleanup(),i._readyState="closed",this.emitReserved("error",a),n?n(a):i.maybeReconnectOnOpen()});if(!1!==this._timeout){const a=this._timeout;0===a&&o();const h=this.setTimeoutFn(()=>{o(),t.close(),t.emit("error",new Error("timeout"))},a);this.opts.autoUnref&&h.unref(),this.subs.push(function(){clearTimeout(h)})}return this.subs.push(o),this.subs.push(r),this}connect(n){return this.open(n)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const n=this.engine;this.subs.push(p(n,"ping",this.onping.bind(this)),p(n,"data",this.ondata.bind(this)),p(n,"error",this.onerror.bind(this)),p(n,"close",this.onclose.bind(this)),p(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(n){try{this.decoder.add(n)}catch(t){this.onclose("parse error",t)}}ondecoded(n){ft(()=>{this.emitReserved("packet",n)},this.setTimeoutFn)}onerror(n){this.emitReserved("error",n)}socket(n,t){let i=this.nsps[n];return i||(i=new H(this,n,t),this.nsps[n]=i),i}_destroy(n){const t=Object.keys(this.nsps);for(const i of t)if(this.nsps[i].active)return;this._close()}_packet(n){const t=this.encoder.encode(n);for(let i=0;i<t.length;i++)this.engine.write(t[i],n.options)}cleanup(){this.subs.forEach(n=>n()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(n,t){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",n,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const n=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();this._reconnecting=!0;const i=this.setTimeoutFn(()=>{n.skipReconnect||(this.emitReserved("reconnect_attempt",n.backoff.attempts),!n.skipReconnect&&n.open(o=>{o?(n._reconnecting=!1,n.reconnect(),this.emitReserved("reconnect_error",o)):n.onreconnect()}))},t);this.opts.autoUnref&&i.unref(),this.subs.push(function(){clearTimeout(i)})}}onreconnect(){const n=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",n)}}const P={};function m(s,n){"object"==typeof s&&(n=s,s=void 0);const t=function re(s,n="",t){let i=s;t=t||"undefined"!=typeof location&&location,null==s&&(s=t.protocol+"//"+t.host),"string"==typeof s&&("/"===s.charAt(0)&&(s="/"===s.charAt(1)?t.protocol+s:t.host+s),/^(https?|wss?):\/\//.test(s)||(s=void 0!==t?t.protocol+"//"+s:"https://"+s),i=U(s)),i.port||(/^(http|ws)$/.test(i.protocol)?i.port="80":/^(http|ws)s$/.test(i.protocol)&&(i.port="443")),i.path=i.path||"/";const r=-1!==i.host.indexOf(":")?"["+i.host+"]":i.host;return i.id=i.protocol+"://"+r+":"+i.port+n,i.href=i.protocol+"://"+r+(t&&t.port===i.port?"":":"+i.port),i}(s,(n=n||{}).path||"/socket.io"),i=t.source,o=t.id;let d;return n.forceNew||n["force new connection"]||!1===n.multiplex||P[o]&&t.path in P[o].nsps?d=new Z(i,n):(P[o]||(P[o]=new Z(i,n)),d=P[o]),t.query&&!n.query&&(n.query=t.queryKey),d.socket(t.path,n)}Object.assign(m,{Manager:Z,Socket:H,io:m,connect:m});var me=l(520);let _e=(()=>{class s{constructor(t){this.http=t,this.message$=new At.X(""),this.socket=m(x.N.endPointUrl),this.getNewMessage=()=>(this.socket.on("receiveMessage",i=>{console.log(i),this.message$.next(i)}),this.message$.asObservable())}getInboxData(){return this.http.get(`${x.N.endPointUrl}/user/travelling/chat/inbox`)}fetchChatHistory(t,i){return this.http.get(`${x.N.endPointUrl}/user/travelling/chat/chat-history/${t}?booking_id=${i}`)}uploadChatImage(t,i){return this.http.put(`${x.N.endPointUrl}/user/travelling/chat/inbox/upload/${t}`,i)}socketConnect(){this.socket.connect()}sendMessage(t){this.socket.emit("sendMessage",t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(me.eN))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();var ye=l(6010),be=l(9592),I=l(7152),ve=l(9113),vt=l(1894),xe=l(5181),xt=l(2683),Ct=l(3087),V=l(1047),w=l(3075),Ce=l(1515);function ke(s,n){1&s&&(e.TgZ(0,"li",13),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&s&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"PlaceDetails.ServiceFees")))}function Oe(s,n){1&s&&(e.TgZ(0,"li",13),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&s&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"PlaceDetails.Vat")))}function Me(s,n){1&s&&(e.TgZ(0,"li",13),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&s&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"PlaceDetails.Insurance")))}function Pe(s,n){if(1&s&&(e.TgZ(0,"li",14),e._uU(1),e.qZA()),2&s){const t=e.oxw(2);e.xp6(1),e.hij("",((null==t.bookingDetails?null:t.bookingDetails.base_price)*(null==t.bookingDetails?null:t.bookingDetails.no_of_nights)*(t.serviceFees/100)).toFixed(2)," SAR")}}function we(s,n){if(1&s&&(e.TgZ(0,"li",14),e._uU(1),e.qZA()),2&s){const t=e.oxw(2);e.xp6(1),e.hij("",((null==t.bookingDetails?null:t.bookingDetails.base_price)*(null==t.bookingDetails?null:t.bookingDetails.no_of_nights)*(t.vat/100)).toFixed(2)," SAR")}}function Te(s,n){if(1&s&&(e.TgZ(0,"li",14),e._uU(1),e.qZA()),2&s){const t=e.oxw(2);e.xp6(1),e.hij("",null==t.bookingDetails?null:t.bookingDetails.insurance," SAR")}}function Ae(s,n){if(1&s&&(e.TgZ(0,"section",1)(1,"div",2)(2,"div",3)(3,"h4",4),e._uU(4),e.qZA()(),e._UZ(5,"i",5),e.qZA(),e.TgZ(6,"div",6)(7,"div",7),e._UZ(8,"img",8),e.qZA(),e.TgZ(9,"div",3)(10,"span",9),e._uU(11),e.ALo(12,"translate"),e.TgZ(13,"span",10),e._uU(14),e.qZA()()()(),e.TgZ(15,"div",11)(16,"div",12)(17,"span",13),e._uU(18),e.ALo(19,"translate"),e.qZA(),e.TgZ(20,"span",14)(21,"span"),e._uU(22),e.ALo(23,"date"),e.qZA(),e._uU(24," - "),e.TgZ(25,"span"),e._uU(26),e.ALo(27,"date"),e.qZA()()()(),e.TgZ(28,"div",15)(29,"div",16)(30,"h4"),e._uU(31),e.ALo(32,"translate"),e.qZA()(),e.TgZ(33,"div",17)(34,"ul",18)(35,"li",13),e._uU(36),e.ALo(37,"translate"),e.qZA(),e.YNc(38,ke,3,3,"li",19),e.YNc(39,Oe,3,3,"li",19),e.YNc(40,Me,3,3,"li",19),e.qZA(),e.TgZ(41,"ul",20)(42,"li",14),e._uU(43),e.qZA(),e.YNc(44,Pe,2,1,"li",21),e.YNc(45,we,2,1,"li",21),e.YNc(46,Te,2,1,"li",21),e.qZA()(),e.TgZ(47,"div",22)(48,"h3",23),e._uU(49),e.ALo(50,"translate"),e.qZA(),e.TgZ(51,"h3",23),e._uU(52),e.qZA()()()()),2&s){const t=e.oxw();e.xp6(4),e.hij("",null==t.bookingDetails?null:t.bookingDetails.property_name," "),e.xp6(4),e.Q6J("src",null==t.bookingDetails?null:t.bookingDetails.cover_photo,e.LSH),e.xp6(3),e.hij("",e.lcZ(12,21,"PlaceDetails.HostedBy")," : "),e.xp6(3),e.AsE("",null==t.bookingDetails||null==t.bookingDetails.host?null:t.bookingDetails.host.first_name," ",null==t.bookingDetails||null==t.bookingDetails.host?null:t.bookingDetails.host.last_name,""),e.xp6(4),e.Oqu(e.lcZ(19,23,"Chat.Booking")),e.xp6(4),e.Oqu(e.xi3(23,25,null==t.bookingDetails?null:t.bookingDetails.booked_from,"shortDate")),e.xp6(4),e.Oqu(e.xi3(27,28,null==t.bookingDetails?null:t.bookingDetails.booked_to,"shortDate")),e.xp6(5),e.Oqu(e.lcZ(32,31,"Chat.PaymentDetails")),e.xp6(5),e.lnq("",null==t.bookingDetails?null:t.bookingDetails.base_price," x ",null==t.bookingDetails?null:t.bookingDetails.no_of_nights," ",e.lcZ(37,33,"PlaceDetails.Night"),""),e.xp6(2),e.Q6J("ngIf",t.serviceFees),e.xp6(1),e.Q6J("ngIf",t.vat),e.xp6(1),e.Q6J("ngIf",null==t.bookingDetails?null:t.bookingDetails.insurance),e.xp6(3),e.hij("",((null==t.bookingDetails?null:t.bookingDetails.base_price)*(null==t.bookingDetails?null:t.bookingDetails.no_of_nights)).toFixed(2)," SAR"),e.xp6(1),e.Q6J("ngIf",t.serviceFees),e.xp6(1),e.Q6J("ngIf",t.vat),e.xp6(1),e.Q6J("ngIf",null==t.bookingDetails?null:t.bookingDetails.insurance),e.xp6(3),e.Oqu(e.lcZ(50,35,"PlaceDetails.TotalPrice")),e.xp6(3),e.hij("",null==t.bookingDetails?null:t.bookingDetails.price_total," SAR")}}let De=(()=>{class s{constructor(t){this.propertyBookingService=t,this.subscriptions=new X.w0}ngOnInit(){this.fetchVatDetails()}fetchVatDetails(){this.subscriptions.add(this.propertyBookingService.fetchVatDetails().subscribe(t=>{var i,o;console.log(t),(null==t?void 0:t.successful)&&(this.serviceFees=null===(i=null==t?void 0:t.data)||void 0===i?void 0:i.service_fee,this.vat=null===(o=null==t?void 0:t.data)||void 0===o?void 0:o.vat)}))}ngOnDestroy(){this.subscriptions.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Ce.v))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-details-booking"]],inputs:{bookingDetails:"bookingDetails"},decls:1,vars:1,consts:[["class","booking-masse",4,"ngIf"],[1,"booking-masse"],[1,"details","d-flex","justify-content-between","align-items-center"],[1,"d-flex","flex-column"],[1,"title-details"],["nz-icon","","nzType","right","nzTheme","outline"],[1,"hosted","d-flex","align-items-center"],[1,"img-avatar"],["alt","",3,"src"],[1,"name"],[1,"h-name"],[1,"date-guest"],[1,"d-flex","justify-content-between","align-items-center"],[1,"desc"],[1,"main-font"],[1,"payment-detail"],[1,"title","d-flex","justify-content-between","align-items-center"],[1,"conta-list","d-flex","justify-content-between","align-items-center"],[1,"list-price","first-list","list-unstyled"],["class","desc",4,"ngIf"],[1,"list-price","secound-list","list-unstyled"],["class","main-font",4,"ngIf"],[1,"total","d-flex","justify-content-between","align-items-center"],[1,"my-0"]],template:function(t,i){1&t&&e.YNc(0,Ae,53,37,"section",0),2&t&&e.Q6J("ngIf",i.bookingDetails)},directives:[y.O5,xt.w,Ct.Ls],pipes:[A.X$,y.uU],styles:[".booking-masse[_ngcontent-%COMP%]   .main-font[_ngcontent-%COMP%]{color:var(--bs-dark);font-size:14px;font-weight:600}.booking-masse[_ngcontent-%COMP%]   .desc[_ngcontent-%COMP%]{color:var(--bs-gray-600);font-size:14px}.booking-masse[_ngcontent-%COMP%]   .main-font.discount[_ngcontent-%COMP%]{color:var(--font-success)}.booking-masse[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{padding:28px 30px;border-bottom:1px solid #E6E6E6}.booking-masse[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:20px;font-weight:700;line-height:30px;color:var(--bs-dark);margin-bottom:0}.booking-masse[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:20px;cursor:pointer}.booking-masse[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%], .booking-masse[_ngcontent-%COMP%]   .date-guest[_ngcontent-%COMP%]{border-bottom:1px solid #E6E6E6;padding:20px 25px}.booking-masse[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   .title-details[_ngcontent-%COMP%], .booking-masse[_ngcontent-%COMP%]   .date-guest[_ngcontent-%COMP%]   .title-details[_ngcontent-%COMP%]{font-size:16px;font-weight:600;color:var(--bs-dark);margin-bottom:5px}.booking-masse[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   i[_ngcontent-%COMP%], .booking-masse[_ngcontent-%COMP%]   .date-guest[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:20px;cursor:pointer;display:block;margin-inline-start:20px}.booking-masse[_ngcontent-%COMP%]   .hosted[_ngcontent-%COMP%]{padding:15px 25px;border-bottom:1px solid #E6E6E6}.booking-masse[_ngcontent-%COMP%]   .hosted[_ngcontent-%COMP%]   .img-avatar[_ngcontent-%COMP%]{margin-inline-end:12px}.booking-masse[_ngcontent-%COMP%]   .hosted[_ngcontent-%COMP%]   .img-avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:45px;height:45px;border-radius:100%}.booking-masse[_ngcontent-%COMP%]   .hosted[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-size:16px;color:var(--bs-dark)}.booking-masse[_ngcontent-%COMP%]   .hosted[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .h-name[_ngcontent-%COMP%]{font-weight:600;color:var(--bs-blue)}.booking-masse[_ngcontent-%COMP%]   .hosted[_ngcontent-%COMP%]   .reviews[_ngcontent-%COMP%]{color:var(--bs-gray-600);font-size:12px}.booking-masse[_ngcontent-%COMP%]   .payment-details[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px;font-weight:600;line-height:18px;color:var(--bs-dark);margin-block-end:3px}.booking-masse[_ngcontent-%COMP%]   .payment-details[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--bs-gray-600);font-size:12px;line-height:15px}.booking-masse[_ngcontent-%COMP%]   .payment-details[_ngcontent-%COMP%]   .amount[_ngcontent-%COMP%]{font-weight:600;font-size:24px;color:var(--bs-primary)}.booking-masse[_ngcontent-%COMP%]   .payment-detail[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{padding:28px 20px 0;border:none}.booking-masse[_ngcontent-%COMP%]   .payment-detail[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:16px;font-weight:700}.booking-masse[_ngcontent-%COMP%]   .payment-detail[_ngcontent-%COMP%]   .conta-list[_ngcontent-%COMP%]{padding:20px 20px 0}.booking-masse[_ngcontent-%COMP%]   .payment-detail[_ngcontent-%COMP%]   .conta-list[_ngcontent-%COMP%]   .main-font[_ngcontent-%COMP%], .booking-masse[_ngcontent-%COMP%]   .payment-detail[_ngcontent-%COMP%]   .conta-list[_ngcontent-%COMP%]   .desc[_ngcontent-%COMP%]{margin-bottom:15px}.booking-masse[_ngcontent-%COMP%]   .payment-detail[_ngcontent-%COMP%]   .total[_ngcontent-%COMP%]{padding:20px;border-top:1px solid #E6E6E6}.booking-masse[_ngcontent-%COMP%]   .payment-detail[_ngcontent-%COMP%]   .total[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:var(--bs-dark);font-weight:600;font-size:16px}"]}),s})();var Ee=l(9590);function Se(s,n){1&s&&e._UZ(0,"img",36)}function Le(s,n){if(1&s&&e._UZ(0,"img",37),2&s){const t=e.oxw().$implicit;e.Q6J("src",null==t||null==t.receiver?null:t.receiver.avatar,e.LSH)}}function Be(s,n){1&s&&(e.TgZ(0,"span"),e._uU(1,"...."),e.qZA())}function Ne(s,n){if(1&s){const t=e.EpF();e.TgZ(0,"li",25),e.NdJ("click",function(){const r=e.CHM(t).$implicit;return e.oxw(3).openChat(r)}),e.TgZ(1,"div",26),e.YNc(2,Se,1,0,"img",27),e.YNc(3,Le,1,1,"img",28),e.qZA(),e.TgZ(4,"div",29)(5,"span",30),e._uU(6),e.qZA(),e.TgZ(7,"span",31),e._uU(8),e.ALo(9,"slice"),e.YNc(10,Be,2,0,"span",32),e.qZA(),e.TgZ(11,"span",33),e._uU(12),e.ALo(13,"translate"),e.TgZ(14,"span"),e._uU(15),e.ALo(16,"date"),e.qZA(),e._uU(17," - "),e.TgZ(18,"span"),e._uU(19),e.ALo(20,"date"),e.qZA(),e.TgZ(21,"span",34)(22,"span",35),e._uU(23),e.ALo(24,"translate"),e.qZA(),e._uU(25," - "),e.TgZ(26,"span"),e._uU(27),e.ALo(28,"date"),e.qZA()()()()()}if(2&s){const t=n.$implicit;e.xp6(2),e.Q6J("ngIf",!(null!=t&&null!=t.receiver&&t.receiver.avatar)),e.xp6(1),e.Q6J("ngIf",null==t||null==t.receiver?null:t.receiver.avatar),e.xp6(3),e.Oqu(null==t||null==t.receiver?null:t.receiver.first_name),e.xp6(2),e.hij("",e.Dn7(9,11,null==t?null:t.message,0,50)," "),e.xp6(2),e.Q6J("ngIf",(null==t||null==t.message?null:t.message.length)>50),e.xp6(2),e.hij(" ",e.lcZ(13,15,"Chat.Booking")," : "),e.xp6(3),e.Oqu(e.xi3(16,17,null==t||null==t.booking?null:t.booking.booked_from,"shortDate")),e.xp6(4),e.Oqu(e.xi3(20,20,null==t||null==t.booking?null:t.booking.booked_to,"shortDate")),e.xp6(4),e.AsE("",null==t||null==t.booking?null:t.booking.no_of_guests," ",e.lcZ(24,23,"Chat.Guests"),""),e.xp6(4),e.Oqu(e.xi3(28,25,null==t?null:t.created_at,"shortDate"))}}function Ze(s,n){if(1&s&&(e.TgZ(0,"div",22)(1,"ul",23),e.YNc(2,Ne,29,28,"li",24),e.qZA()()),2&s){const t=e.oxw(2);e.xp6(2),e.Q6J("ngForOf",t.inboxData)}}function Ie(s,n){if(1&s){const t=e.EpF();e.TgZ(0,"div",38)(1,"app-empty-state",39),e.NdJ("btnClicked",function(){return e.CHM(t),e.oxw(2).onBrowseBtnClicked()}),e.qZA()()}if(2&s){const t=e.oxw(2);e.xp6(1),e.Q6J("title",t.emptyData.title)("text",t.emptyData.text)("icon",t.emptyData.icon)("withBtn",t.emptyData.withBtn)("btnText",t.emptyData.btnText)}}const $=function(){return{span:24}},Re=function(){return{span:7}};function ze(s,n){if(1&s&&(e.TgZ(0,"div",18)(1,"div",19)(2,"h2"),e._uU(3),e.ALo(4,"translate"),e.qZA()(),e.YNc(5,Ze,3,1,"div",20),e.YNc(6,Ie,2,5,"div",21),e.qZA()),2&s){const t=e.oxw();e.Q6J("nzXs",e.DdM(7,$))("nzLg",e.DdM(8,Re)),e.xp6(3),e.Oqu(e.lcZ(4,5,"Chat.Messages")),e.xp6(2),e.Q6J("ngIf",null==t.inboxData?null:t.inboxData.length),e.xp6(1),e.Q6J("ngIf",!(null!=t.inboxData&&t.inboxData.length||t.loading))}}function qe(s,n){if(1&s&&(e.TgZ(0,"h2"),e._uU(1),e.qZA()),2&s){const t=e.oxw(2);e.xp6(1),e.AsE(" ",null==t.bookingData||null==t.bookingData.traveller?null:t.bookingData.traveller.first_name," ",null==t.bookingData||null==t.bookingData.traveller?null:t.bookingData.traveller.last_name," ")}}function Ue(s,n){if(1&s&&(e.TgZ(0,"h2"),e._uU(1),e.qZA()),2&s){const t=e.oxw(2);e.xp6(1),e.AsE(" ",null==t.bookingData||null==t.bookingData.host?null:t.bookingData.host.first_name," ",null==t.bookingData||null==t.bookingData.host?null:t.bookingData.host.last_name," ")}}function Fe(s,n){if(1&s&&(e.TgZ(0,"div",40),e._UZ(1,"span",41),e.TgZ(2,"div",42),e.YNc(3,qe,2,2,"h2",32),e.YNc(4,Ue,2,2,"h2",32),e.TgZ(5,"span",43),e._uU(6),e.ALo(7,"translate"),e.TgZ(8,"span"),e._uU(9),e.ALo(10,"date"),e.qZA(),e._uU(11," - "),e.TgZ(12,"span"),e._uU(13),e.ALo(14,"date"),e.qZA()()()()),2&s){const t=e.oxw();e.xp6(3),e.Q6J("ngIf",t.userId===(null==t.bookingData||null==t.bookingData.host?null:t.bookingData.host.id)),e.xp6(1),e.Q6J("ngIf",t.userId!=(null==t.bookingData||null==t.bookingData.host?null:t.bookingData.host.id)),e.xp6(2),e.hij(" ",e.lcZ(7,5,"Chat.Booking")," : "),e.xp6(3),e.Oqu(e.xi3(10,7,null==t.bookingData?null:t.bookingData.booked_from,"shortDate")),e.xp6(4),e.Oqu(e.xi3(14,10,null==t.bookingData?null:t.bookingData.booked_to,"shortDate"))}}function Je(s,n){1&s&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&s&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"Chat.HideBookingDetails")))}function Ye(s,n){1&s&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&s&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"Chat.ShowBookingDetails")))}function Qe(s,n){if(1&s){const t=e.EpF();e.TgZ(0,"div",44),e._UZ(1,"div")(2,"div",45),e.TgZ(3,"div",46)(4,"span",47),e.NdJ("click",function(){return e.CHM(t),e.oxw().openShowDetails()}),e.YNc(5,Je,3,3,"span",32),e.YNc(6,Ye,3,3,"span",32),e.qZA()()()}if(2&s){const t=e.oxw();e.xp6(5),e.Q6J("ngIf",t.isShowDetails),e.xp6(1),e.Q6J("ngIf",!t.isShowDetails)}}function He(s,n){1&s&&e._UZ(0,"img",55)}function Ve(s,n){if(1&s&&e._UZ(0,"img",56),2&s){const t=e.oxw().$implicit;e.Q6J("src",null==t||null==t.sender?null:t.sender.avatar,e.LSH)}}function $e(s,n){if(1&s&&(e.TgZ(0,"div",57)(1,"span",58),e._uU(2),e.ALo(3,"date"),e.qZA(),e.TgZ(4,"span",30),e._uU(5),e.qZA()()),2&s){const t=e.oxw().$implicit;e.xp6(2),e.Oqu(e.xi3(3,2,null==t?null:t.created_at,"d, MMM, y, h:mm a")),e.xp6(3),e.Oqu(null==t||null==t.sender?null:t.sender.first_name)}}function Ke(s,n){if(1&s&&(e.TgZ(0,"div",57)(1,"span",30),e._uU(2),e.qZA(),e.TgZ(3,"span",58),e._uU(4),e.ALo(5,"date"),e.qZA()()),2&s){const t=e.oxw().$implicit;e.xp6(2),e.Oqu(null==t||null==t.sender?null:t.sender.first_name),e.xp6(2),e.Oqu(e.xi3(5,2,null==t?null:t.created_at,"d, MMM, y, h:mm a"))}}function Xe(s,n){if(1&s&&(e.TgZ(0,"li",50),e.YNc(1,He,1,0,"img",51),e.YNc(2,Ve,1,1,"img",52),e.TgZ(3,"div",53),e.YNc(4,$e,6,5,"div",54),e.YNc(5,Ke,6,5,"div",54),e.TgZ(6,"span",29),e._uU(7),e.qZA()()()),2&s){const t=n.$implicit,i=e.oxw(2);e.Q6J("ngClass",i.userId===t.sender_id?"sender":"align-items-end"),e.xp6(1),e.Q6J("ngIf",!(null!=t&&null!=t.sender&&t.sender.avatar)),e.xp6(1),e.Q6J("ngIf",null==t||null==t.sender?null:t.sender.avatar),e.xp6(2),e.Q6J("ngIf",i.userId===t.sender_id),e.xp6(1),e.Q6J("ngIf",i.userId!=t.sender_id),e.xp6(2),e.Oqu(null==t?null:t.message)}}function je(s,n){if(1&s&&(e.TgZ(0,"ul",48),e.YNc(1,Xe,8,6,"li",49),e.qZA()),2&s){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.messagesData)}}function We(s,n){if(1&s){const t=e.EpF();e.TgZ(0,"div",59)(1,"app-empty-state",39),e.NdJ("btnClicked",function(){return e.CHM(t),e.oxw().onBrowseBtnClicked()}),e.qZA()()}if(2&s){const t=e.oxw();e.xp6(1),e.Q6J("title",t.emptyMessagesData.title)("text",t.emptyMessagesData.text)("icon",t.emptyMessagesData.icon)("withBtn",t.emptyMessagesData.withBtn)("btnText",t.emptyMessagesData.btnText)}}function Ge(s,n){if(1&s){const t=e.EpF();e.TgZ(0,"i",60),e.NdJ("click",function(){return e.CHM(t),e.MAs(2).click()}),e.qZA(),e._UZ(1,"input",61,62)}}function tn(s,n){1&s&&e._UZ(0,"i",63)}const en=function(){return{span:6}};function nn(s,n){if(1&s&&(e.TgZ(0,"div",64),e._UZ(1,"app-details-booking",65),e.qZA()),2&s){const t=e.oxw();e.Q6J("nzXs",e.DdM(3,$))("nzLg",e.DdM(4,en)),e.xp6(1),e.Q6J("bookingDetails",t.bookingData)}}function sn(s,n){1&s&&e._UZ(0,"span",69)}function on(s,n){if(1&s&&(e.TgZ(0,"div",66),e.YNc(1,sn,1,0,"ng-template",null,67,e.W1O),e._UZ(3,"nz-spin",68),e.qZA()),2&s){const t=e.MAs(2);e.xp6(3),e.Q6J("nzIndicator",t)}}const rn=function(){return{span:22}},kt=function(){return{span:0}},an=function(){return{span:11}},cn=function(s){return{"d-block":s}};let Ot=(()=>{class s{constructor(t,i,o,r,a,h,d){this.chatService=t,this.commonService=i,this.translateService=o,this.cookieService=r,this.route=a,this.router=h,this.bookingsService=d,this.isShowDetails=!1,this.isListMessages=!0,this.isScreenMessages=!0,this.loading=!1,this.inboxData=[],this.msg="",this.messagesData=[],this.userRole=x.N.userRole,this.emptyData={title:"",text:"",icon:"",withBtn:!1,btnText:""},this.emptyMessagesData={title:"",text:"",icon:"",withBtn:!1,btnText:""},this.subscriptions=new X.w0}ngOnInit(){this.getBookingFromRoute(),this.getUserData(),this.handleEmptyInboxData(),this.handleEmptyData(),this.receiveMessage()}getUserData(){var t;this.cookieService.get("userData")&&(this.userId=null===(t=JSON.parse(this.cookieService.get("userData")))||void 0===t?void 0:t.id,this.fetchInboxData(),this.getBookingId())}getBookingFromRoute(){this.route.paramMap.subscribe(t=>{var i,o;console.log(t),(null===(i=null==t?void 0:t.params)||void 0===i?void 0:i.id)&&(this.bookingId=null===(o=null==t?void 0:t.params)||void 0===o?void 0:o.id,this.fetchBookingData())})}getChatHistory(t,i){this.subscriptions.add(this.chatService.fetchChatHistory(t,i).subscribe({next:o=>{var r;console.log(o),(null==o?void 0:o.successful)&&(this.messagesData=null===(r=null==o?void 0:o.data)||void 0===r?void 0:r.messages.reverse(),this.socketConnect())}}))}getBookingId(){this.route.paramMap.subscribe(t=>{var i,o;(null===(i=null==t?void 0:t.params)||void 0===i?void 0:i.id)&&(this.bookingId=null===(o=null==t?void 0:t.params)||void 0===o?void 0:o.id,console.log(this.bookingId),this.bookingId&&this.fetchBookingData())})}fetchBookingData(){this.loading=!0;const t="HOST"===this.userRole?this.bookingsService.getHostBookingDetails(this.bookingId):this.bookingsService.getBookingDetails(this.bookingId);this.subscriptions.add(t.subscribe(i=>{var o,r,a,h,d;this.bookingData=null===(o=null==i?void 0:i.data)||void 0===o?void 0:o.booking,this.receiverId=null===(a=null===(r=this.bookingData)||void 0===r?void 0:r.host)||void 0===a?void 0:a.id,this.loading=!1,this.bookingId=null===(d=null===(h=null==i?void 0:i.data)||void 0===h?void 0:h.booking)||void 0===d?void 0:d.id,this.getChatHistory(this.receiverId,this.bookingId)}))}fetchInboxData(){this.loading=!0,this.subscriptions.add(this.chatService.getInboxData().subscribe({next:t=>{var i,o,r,a,h,d,_,f;this.loading=!1,this.inboxData=null===(i=null==t?void 0:t.data)||void 0===i?void 0:i.allInbox,this.receiverId=null===(o=this.inboxData[0])||void 0===o?void 0:o.receiver_id,this.bookingId=null===(a=null===(r=this.inboxData[0])||void 0===r?void 0:r.booking)||void 0===a?void 0:a.id,(null===(h=this.inboxData)||void 0===h?void 0:h.length)&&this.getChatHistory(null===(d=this.inboxData[0])||void 0===d?void 0:d.receiver_id,null===(f=null===(_=this.inboxData[0])||void 0===_?void 0:_.booking)||void 0===f?void 0:f.id)},error:t=>{var i;this.loading=!1,this.commonService.showErrorAlert(this.translateService.instant("General.Error"),null===(i=null==t?void 0:t.error)||void 0===i?void 0:i.message)}}))}handleEmptyData(){this.emptyMessagesData={title:this.translateService.instant("General.SayHi"),text:"",icon:"assets/imgs/hi-icon.png",withBtn:!1,btnText:this.translateService.instant("General.Browse")}}handleEmptyInboxData(){this.emptyData={title:this.translateService.instant("General.NoData"),text:this.translateService.instant("General.NoMessages"),icon:"https://gw.alipayobjects.com/zos/antfincdn/ZHrcdLPrvN/empty.svg",withBtn:!1,btnText:this.translateService.instant("General.Browse")}}onBrowseBtnClicked(){this.router.navigateByUrl("/")}socketConnect(){this.chatService.socketConnect()}sendMessage(){console.log(this.bookingId);let t={receiver_id:this.receiverId,type:"MESSAGE",booking_id:this.bookingId,message:this.msg};console.log(t),this.chatService.sendMessage(t),this.msg=""}receiveMessage(){this.chatService.getNewMessage().subscribe(t=>{console.log("rr",t),this.messagesData.push(t)})}readAllMessage(t,i){}openChat(t){var i,o;console.log(t),this.bookingId=null===(i=null==t?void 0:t.booking)||void 0===i?void 0:i.id,this.receiverId=(null==t?void 0:t.receiver_id)===this.userId?null==t?void 0:t.sender_id:null==t?void 0:t.receiver_id,this.fetchBookingData(),this.getChatHistory(this.receiverId,null===(o=null==t?void 0:t.booking)||void 0===o?void 0:o.id)}openShowDetails(){0==this.isScreenMessages&&(this.isScreenMessages=!this.isScreenMessages),this.isShowDetails=!this.isShowDetails}ngOnDestroy(){this.subscriptions.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(_e),e.Y36(ye.v),e.Y36(A.sK),e.Y36(be.N_),e.Y36(I.gz),e.Y36(I.F0),e.Y36(ve.F))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-messages-layout"]],decls:20,vars:23,consts:[["nz-row","","id","chat"],["nz-col","",1,"m-auto",3,"nzXs","nzLg"],["nz-row","",1,"layouts"],["nz-col","","class","border-start-0 list-chats",3,"nzXs","nzLg",4,"ngIf"],["nz-col","",1,"border-start-0","chats-screen",3,"nzXs","nzLg","nzMd","ngClass"],["class","d-flex justify-content-between align-items-center name-chat",4,"ngIf"],[1,"mess"],["class","head",4,"ngIf"],["class","list-unstyled",4,"ngIf"],[1,"mt-5","mb-5"],["class","empty-state mt-5 mb-5",4,"ngIf"],[1,"input-mess"],[3,"nzSuffix","nzPrefix"],["type","text","nz-input","","placeholder","Type a Message",3,"ngModel","ngModelChange","keyup.enter"],["prefixTemplateUser",""],["suffixTemplateInfo",""],["nz-col","","class","border-start-0 border-end-0","style","overflow-y: scroll",3,"nzXs","nzLg",4,"ngIf"],["class","loader-wrapper mt-3",4,"ngIf"],["nz-col","",1,"border-start-0","list-chats",3,"nzXs","nzLg"],[1,"title"],["class","pepole",4,"ngIf"],["class","empty-state mb-5",4,"ngIf"],[1,"pepole"],[1,"pepole-list","list-unstyled"],["class","list-item",3,"click",4,"ngFor","ngForOf"],[1,"list-item",3,"click"],[1,"img-avatar"],["src","https://avatars0.githubusercontent.com/u/22736418?s=88&v=4","class","img-fluid","alt","img-avatar",4,"ngIf"],["class","img-fluid","alt","img-avatar",3,"src",4,"ngIf"],[1,"content"],[1,"name"],[1,"message"],[4,"ngIf"],[1,"details-booking","d-block"],[1,"d-block"],[1,"guest"],["src","https://avatars0.githubusercontent.com/u/22736418?s=88&v=4","alt","img-avatar",1,"img-fluid"],["alt","img-avatar",1,"img-fluid",3,"src"],[1,"empty-state","mb-5"],[3,"title","text","icon","withBtn","btnText","btnClicked"],[1,"d-flex","justify-content-between","align-items-center","name-chat"],["nz-icon","","nzType","caret-left","nzTheme","outline",1,"d-md-none","d-block","ms-4"],[1,"title","border-bottom-0"],[1,"details-booking"],[1,"head"],[1,"date"],[1,"show-details"],[1,"details-trigger",3,"click"],[1,"list-unstyled"],["class","item-mess d-flex",3,"ngClass",4,"ngFor","ngForOf"],[1,"item-mess","d-flex",3,"ngClass"],["src","https://avatars0.githubusercontent.com/u/22736418?s=88&v=4","alt","",4,"ngIf"],["alt","",3,"src",4,"ngIf"],[1,"d-flex","flex-column"],["class","name-date",4,"ngIf"],["src","https://avatars0.githubusercontent.com/u/22736418?s=88&v=4","alt",""],["alt","",3,"src"],[1,"name-date"],[1,"time"],[1,"empty-state","mt-5","mb-5"],["nz-icon","","nzType","link","nzTheme","outline",3,"click"],["type","file",1,"d-none"],["imgFile",""],["nz-icon","","nzType","send","nzTheme","outline"],["nz-col","",1,"border-start-0","border-end-0",2,"overflow-y","scroll",3,"nzXs","nzLg"],[3,"bookingDetails"],[1,"loader-wrapper","mt-3"],["indicatorTemplate",""],["nzSimple","",3,"nzIndicator"],["nz-icon","","nzType","loading"]],template:function(t,i){if(1&t&&(e.TgZ(0,"section",0)(1,"div",1)(2,"div",2),e.YNc(3,ze,7,9,"div",3),e.TgZ(4,"div",4),e.YNc(5,Fe,15,13,"div",5),e.TgZ(6,"div",6),e.YNc(7,Qe,7,2,"div",7),e.YNc(8,je,2,1,"ul",8),e.TgZ(9,"div",9),e.YNc(10,We,2,5,"div",10),e.qZA()(),e.TgZ(11,"div",11)(12,"nz-input-group",12)(13,"input",13),e.NdJ("ngModelChange",function(r){return i.msg=r})("keyup.enter",function(){return i.sendMessage()}),e.qZA()(),e.YNc(14,Ge,3,0,"ng-template",null,14,e.W1O),e.YNc(16,tn,1,0,"ng-template",null,15,e.W1O),e.qZA()(),e.YNc(18,nn,2,5,"div",16),e.qZA()()(),e.YNc(19,on,4,1,"div",17)),2&t){const o=e.MAs(15),r=e.MAs(17);e.xp6(1),e.Q6J("nzXs",e.DdM(16,$))("nzLg",e.DdM(17,rn)),e.xp6(2),e.Q6J("ngIf",i.isListMessages),e.xp6(1),e.Q6J("nzXs",e.DdM(18,kt))("nzLg",e.DdM(19,an))("nzMd",e.DdM(20,kt))("ngClass",e.VKq(21,cn,0==i.isScreenMessages)),e.xp6(1),e.Q6J("ngIf",i.bookingData),e.xp6(2),e.Q6J("ngIf",i.bookingData),e.xp6(1),e.Q6J("ngIf",i.messagesData.length),e.xp6(2),e.Q6J("ngIf",!i.messagesData.length),e.xp6(2),e.Q6J("nzSuffix",r)("nzPrefix",o),e.xp6(1),e.Q6J("ngModel",i.msg),e.xp6(5),e.Q6J("ngIf",i.isShowDetails),e.xp6(1),e.Q6J("ngIf",i.loading)}},directives:[vt.SK,vt.t3,y.O5,y.sg,xe.s,y.mk,xt.w,Ct.Ls,V.gB,V.ke,V.Zp,w.Fj,w.JJ,w.On,De,Ee.W],pipes:[A.X$,y.OU,y.uU],styles:["#chat[_ngcontent-%COMP%]{position:relative}#chat[_ngcontent-%COMP%]   .layouts[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{max-height:100vh;border:1px solid #E6E6E6}#chat[_ngcontent-%COMP%]   .chats-screen[_ngcontent-%COMP%], #chat[_ngcontent-%COMP%]   .list-chats[_ngcontent-%COMP%]{overflow-y:scroll}#chat[_ngcontent-%COMP%]   .name-chat[_ngcontent-%COMP%]{border-bottom:1px solid #E6E6E6}#chat[_ngcontent-%COMP%]   .name-chat[_ngcontent-%COMP%]   .report[_ngcontent-%COMP%]{color:var(--font-danger);text-decoration:underline;cursor:pointer;padding-inline-end:20px}#chat[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{padding:28px 10px;border-bottom:1px solid #E6E6E6}#chat[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:20px;font-weight:700;line-height:30px;color:var(--bs-dark);margin-bottom:0}#chat[_ngcontent-%COMP%]   .details-booking[_ngcontent-%COMP%]{font-size:10px;color:var(--bs-gray-600)}#chat[_ngcontent-%COMP%]   .details-booking[_ngcontent-%COMP%]   .guest[_ngcontent-%COMP%]{color:var(--bs-blue);font-weight:600}#chat[_ngcontent-%COMP%]   .chats-screen[_ngcontent-%COMP%]   .details-booking[_ngcontent-%COMP%]{font-size:12px}#chat[_ngcontent-%COMP%]   .pepole[_ngcontent-%COMP%]   .list-item[_ngcontent-%COMP%]{transition:.3s background-color;padding:25px 10px;border-bottom:1px solid #E6E6E6}#chat[_ngcontent-%COMP%]   .pepole[_ngcontent-%COMP%]   .list-item[_ngcontent-%COMP%]:hover{background-color:#f3f3f3}@media (max-width: 991px){#chat[_ngcontent-%COMP%]   .pepole[_ngcontent-%COMP%]   .list-item[_ngcontent-%COMP%]{padding:15px 10px}}#chat[_ngcontent-%COMP%]   .pepole[_ngcontent-%COMP%]   .list-item[_ngcontent-%COMP%]   .img-avatar[_ngcontent-%COMP%]{display:inline-block;vertical-align:text-bottom}#chat[_ngcontent-%COMP%]   .pepole[_ngcontent-%COMP%]   .list-item[_ngcontent-%COMP%]   .img-avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:60px;height:60px;border-radius:100%;object-fit:fill}#chat[_ngcontent-%COMP%]   .pepole[_ngcontent-%COMP%]   .list-item[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{display:inline-block;width:70%;padding-inline-start:10px}#chat[_ngcontent-%COMP%]   .pepole[_ngcontent-%COMP%]   .list-item[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-size:15px;color:var(--bs-dark);font-weight:500;display:block}#chat[_ngcontent-%COMP%]   .pepole[_ngcontent-%COMP%]   .list-item[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]{font-size:12px;color:var(--bs-gray-600);display:block}#chat[_ngcontent-%COMP%]   .pepole[_ngcontent-%COMP%]   .list-item[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:10px;color:var(--bs-gray-600);font-weight:600}#chat[_ngcontent-%COMP%]   .chats-screen[_ngcontent-%COMP%]   .mess[_ngcontent-%COMP%]{padding:30px 30px 40px;min-height:44vh;height:44vh}#chat[_ngcontent-%COMP%]   .chats-screen[_ngcontent-%COMP%]   .mess[_ngcontent-%COMP%]   .head[_ngcontent-%COMP%]{width:100%;margin-bottom:1em;position:sticky}#chat[_ngcontent-%COMP%]   .chats-screen[_ngcontent-%COMP%]   .mess[_ngcontent-%COMP%]   .head[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]{font-size:10px;color:var(--bs-gray-600);display:block;text-align:center;width:100%}#chat[_ngcontent-%COMP%]   .chats-screen[_ngcontent-%COMP%]   .mess[_ngcontent-%COMP%]   .head[_ngcontent-%COMP%]   .show-details[_ngcontent-%COMP%]{display:block;font-size:14px;color:var(--bs-dark);text-align:end}#chat[_ngcontent-%COMP%]   .chats-screen[_ngcontent-%COMP%]   .mess[_ngcontent-%COMP%]   .head[_ngcontent-%COMP%]   .show-details[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{width:-moz-fit-content;width:fit-content;text-decoration:underline;cursor:pointer}#chat[_ngcontent-%COMP%]   .chats-screen[_ngcontent-%COMP%]   .mess[_ngcontent-%COMP%]   .item-mess[_ngcontent-%COMP%]{margin-bottom:20px}#chat[_ngcontent-%COMP%]   .chats-screen[_ngcontent-%COMP%]   .mess[_ngcontent-%COMP%]   .item-mess[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:40px;height:40px;display:block;margin-inline-end:13px;border-radius:100%;object-fit:fill}#chat[_ngcontent-%COMP%]   .chats-screen[_ngcontent-%COMP%]   .mess[_ngcontent-%COMP%]   .item-mess[_ngcontent-%COMP%]   .name-date[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-size:14px;font-weight:600;color:var(--bs-dark)}#chat[_ngcontent-%COMP%]   .chats-screen[_ngcontent-%COMP%]   .mess[_ngcontent-%COMP%]   .item-mess[_ngcontent-%COMP%]   .name-date[_ngcontent-%COMP%]   .time[_ngcontent-%COMP%]{margin-inline-start:8px;margin-inline-end:8px;color:var(--bs-gray-600);font-size:12px}#chat[_ngcontent-%COMP%]   .chats-screen[_ngcontent-%COMP%]   .mess[_ngcontent-%COMP%]   .item-mess[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{display:block;font-size:12px;color:var(--bs-gray-600)}[_ngcontent-%COMP%]::-webkit-scrollbar{width:5px;border-radius:10px}[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f1f1;border-radius:10px}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#d4d1d1;border-radius:10px}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#a09e9e}  input{width:100%;border:none;outline:none;padding:10px;border-radius:8px;font-size:16px;font-weight:500;margin-block-end:10px}  .ant-input-suffix,   .ant-input-prefix{margin-inline-end:15px}  .ant-input-suffix .anticon svg,   .ant-input-prefix .anticon svg{font-size:22px;color:#b8b8b8}  .ant-input-suffix .anticon{background-color:var(--bs-primary);width:40px;height:40px;border-radius:100%;display:flex;justify-content:center;align-items:center;padding:8px;cursor:pointer}  .ant-input-suffix .anticon svg{font-size:22px;color:#f1f1f1}  .ant-input-affix-wrapper{padding:18px 17px;padding-inline-end:10px;border:none;border-radius:8px;margin-block-end:10px;bottom:0;max-width:100%}  .ant-input-affix-wrapper:focus{border-color:transparent;box-shadow:none;border-right-width:0!important;outline:0}  .ant-input:focus{border-right-width:0!important}  .ant-input-affix-wrapper>input.ant-input{margin-block-end:0}.sender[_ngcontent-%COMP%]{justify-content:start;direction:rtl;text-align:start}.sender[_ngcontent-%COMP%]   .name-date[_ngcontent-%COMP%]{direction:ltr}.loader-wrapper[_ngcontent-%COMP%]{justify-content:center;text-align:center;min-height:60vh;display:flex;align-items:center}.loader-wrapper[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:2em}"]}),s})();const ln=[{path:"",component:Ot},{path:":id",component:Ot}];let hn=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[[I.Bz.forChild(ln)],I.Bz]}),s})();var un=l(8306),dn=l(3099);class Mt{constructor(n){this.config=n,this.subscribersCounter={},this.eventObservables$={},this.emptyConfig={url:"",options:{}},void 0===n&&(n=this.emptyConfig),this.ioSocket=(m||z)(n.url,n.options)}of(n){this.ioSocket.of(n)}on(n,t){this.ioSocket.on(n,t)}once(n,t){this.ioSocket.once(n,t)}connect(){return this.ioSocket.connect()}disconnect(n){return this.ioSocket.disconnect.apply(this.ioSocket,arguments)}emit(n,...t){return this.ioSocket.emit.apply(this.ioSocket,arguments)}removeListener(n,t){return this.ioSocket.removeListener.apply(this.ioSocket,arguments)}removeAllListeners(n){return this.ioSocket.removeAllListeners.apply(this.ioSocket,arguments)}fromEvent(n){return this.subscribersCounter[n]||(this.subscribersCounter[n]=0),this.subscribersCounter[n]++,this.eventObservables$[n]||(this.eventObservables$[n]=new un.y(t=>{const i=o=>{t.next(o)};return this.ioSocket.on(n,i),()=>{this.subscribersCounter[n]--,0===this.subscribersCounter[n]&&(this.ioSocket.removeListener(n,i),delete this.eventObservables$[n])}}).pipe((0,dn.B)())),this.eventObservables$[n]}fromOneTimeEvent(n){return new Promise(t=>this.once(n,t))}}function pn(s){return new Mt(s)}const Pt=new e.OlP("__SOCKET_IO_CONFIG__");let gn=(()=>{class s{static forRoot(t){return{ngModule:s,providers:[{provide:Pt,useValue:t},{provide:Mt,useFactory:pn,deps:[Pt]}]}}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({}),s})();var fn=l(5326);const mn={url:x.N.endPointUrl,options:{transports:["websocket"]}};let _n=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[[y.ez,hn,Tt.P,A.aw,w.u5,w.UX,fn.m,gn.forRoot(mn)]]}),s})()}}]);